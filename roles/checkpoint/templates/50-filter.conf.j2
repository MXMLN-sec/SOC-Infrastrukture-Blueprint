# DO NOT EDIT THIS FILE - RISK OF CONFIGURATION INCONSISTENCY
# DEPLOY ANY CHANGES WITH ANSIBLE FROM THE CORRESPONDING BITBUCKET REPOSITORY

filter {
  # mutate {
  #   remove_field => [ "syslog", "hostname", "host", "port", "@version"]
  # }
  mutate {
    rename => ["host", "[observer][ip]" ]
    rename => ["sourceAddress", "[source][ip]" ]
    rename => ["destinationAddress", "[destination][ip]" ]
    rename => ["destinationPort", "[destination][port]" ]
    rename => ["deviceVendor", "[cef][device][vendor]" ]
    rename => ["deviceVersion", "[cef][device][version]" ]
    rename => ["deviceProduct", "[cef][device][product]" ]
    rename => ["deviceEventClassId", "[cef][device][event_claas_id]" ]
  }

  if !([agent][name] and [agent][type]) {
    mutate {
      add_field => {
        "[agent][name]" => "mcn-mat-ece-logstash-01"
        "[agent][type]" => "logstash"
      }
    }
  }
}